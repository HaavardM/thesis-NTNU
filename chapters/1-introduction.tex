\chapter{Introduction}

Humans, while resourceful, are prone to loss of focus, tiredness and have limited attention span. Human errors are estimated to contribute to more than $75\%$ of maritime accidents \cite{Tengesdal2020RiskbasedAM}. On the contrary, computers always remain "focused" and never gets tired. Using autonomus ships in order to reduce the potential for human errors can greatly reduce the number of maritime accidents.
While completely avoiding humans at sea would increase safety, it simply is unrealistic. Autonomous ships will need cooperate with humans on nearby vessels to avoid dangerous situations. Such up-to-date situational awareness is critical to develop decision-making systems in dynamic environments \cite{endsley}. Robust \acrfull{colav} are necessary to  maneuver in areas with potential obstacles in order to avoid collisions. However, the optimal decision is usually highly situation-dependent and requires ability to understand and predict the traffic patterns of nearby vessels, either controlled by humans or autonomous. The optimal decision are further influenced by conventions such as \Gls{colregs}, especially for larger vessels. Still, some scenarios may even require rules and conventions to be broken due to unforeseen circumstances.
However, teaching machines situational awareness is not an easy task. Human's remarkable ability to recognize situations from observations is very hard to replicate in an autonomous systems.

\section{Existing research}
 Existing research on intention modelling for autonomous ships is limited. \cite{Tengesdal2020RiskbasedAM} propose a Probabilistic Scenario-Based Model Predictive Control scheme which is able to utilize probabilistic information about obstacle intentions. It demonstrates how it is possible to make safer decisions when utilizing the additional intent information. The paper propose a general framework for intention inference using \acrfull{bn}, allowing several factors to influence an obstacle's intention. However, the paper only propose an illustrative model where the parameters of the model are assumed known and do not further discuss how these models can be found or used in practice.  

Some related research has been made in the area of autonomous cars. \cite{song} explore how Hidden Markov Models (HMM) can be used to infer the intention of cars in an intersection and then utilize this information in a partially observable Markov decision process (POMDP). 


\section{Bayesian Networks}
Bayesian Networks, often called Belief Networks, are Probabilistic Graphical Models represented as directed acyclic graphs \cite{murphy}. There is strictly speaking nothing Bayesian about Bayesian Networks (they may just as well be used with Frequentist statistics), as it is simply a way to describe probability distributions. Bayesian Networks are also often used to represent causal relations, though the interactions are in no way required to be causal. However, the causal interpretation of Bayesian Networks allow humans to intuitively understand relations between variables. Bayesian Networks are for this reason heavily used in Causal Inference, which attempts to model and infer true causal relationships between variables \cite{causal}. Bayesian Networks intuitive structure further allows human domain experts to reason about and participate in the development of statistical models, without requiring deep statistical knowledge. 
This makes Bayesian Networks a good choice for intention models, as the model need to incorporate prior knowledge such as intuitive reasoning, human experts and predefined rules (such as \Gls{colregs}), as well as be able to learn from new and historical observations. 

\section{Goal}
This thesis will investigate how inference can be performed from available data in a Bayesian Network. At this point the goal is not to find a realistic intention model, but rather try to develop a flexible framework for inference in a known model. Methods which makes few assumptions about the model and makes it easy to incorporate existing knowledge will be the main focus of this thesis. This choice comes from a belief that a good intention model will need to strongly rely on prior knowledge from human experts and from predefined rules. Restricting the model by assumptions made by the inference methods, may end up restricting the ability to accurately encode such information into the model. Approximate Methods such as \acrfull{mcmc} and \acrfull{vi} will therefore be explored in greater detail, while exact methods are only presented as possible solutions for special cases where the assumptions are reasonable. The methods can in some cases be combined, by utilizing exact inference wherever the assumptions are reasonable, and fall back to approximate methods on the parts where exact methods falls short \cite{winnbishop}.
This thesis is structured into multiple chapters. Some necessary theoretical background, mainly an introduction to Bayesian Statistics and \acrfull{pgm}'s, are presented in \cref{chap:theory}. The theory for \acrshort{mcmc} based methods are then found in \cref{chap:mcmc}, while exact and approximate analytical methods are found in \cref{chap:analytical}. In order to not only present the theoretical concepts, implementations of \acrshort{mcmc} and \acrshort{vi} are compared on a fictitious model in \cref{chap:impl}. Finally, the theory and results for the different methods are then compared and discussed in \cref{chap:discussion}.